# AI協働のコツ (AI Collaboration Tips)

> **対象**: AIアシスタント（Claude等）と協働開発を行う開発者向けのガイド

このドキュメントでは、AIアシスタントとの開発効率を最大化するためのコミュニケーション方法を紹介します。

---

## ガイドラインの書き方

### プロンプト階層を使う

**推奨**: CLAUDE.mdなどのガイドラインを更新する際は、指示の重要度を明確にしましょう。

**理由**: AIは重要度が明示されていると、適切な判断を下しやすくなります（Anthropic公式ベストプラクティスより）。

**3段階の重要度**:

#### NEVER（絶対禁止）
セキュリティ・安全性の境界。例外を認めないルール。

**例**:
- NEVER: PII（個人情報）を `localStorage` に平文保存してはならない
- NEVER: トークンを `console.log` に出力してはならない

#### YOU MUST（必須要件）
基本的に遵守すべき要件。例外は稀。

**例**:
- YOU MUST: エラー時は必ず `console.error` で原因を出力すること
- YOU MUST: SPA遷移時には全ての MutationObserver を破棄すること

#### IMPORTANT（重要な考慮事項）
推奨事項。状況に応じた判断は許容。

**例**:
- IMPORTANT: パフォーマンスのため、`waitForElement` を推奨
- IMPORTANT: DOM依存を避け、`HenryCore` API経由でデータ取得を推奨

**使い分けのポイント**:
- セキュリティ・安全性 → **NEVER**
- 動作に必須 → **YOU MUST**
- ベストプラクティス → **IMPORTANT**

---

## 効果的なコミュニケーション

### 視覚的フィードバックの活用

**推奨**: UI要件や問題の説明には、スクリーンショットやモックアップを積極的に活用しましょう。

**理由**: 文章だけの説明より、視覚的コンテキストを共有することで、AIの理解精度が大幅に向上します（Anthropic公式ベストプラクティスより）。

**具体例**:
- ✅ **良い**: 「このエラー画面のスクリーンショットを見てください。赤い警告が表示されています」
- ❌ **悪い**: 「エラーが出ています」（どんなエラーか不明確）

**活用シーン**:
- UI実装の要件を伝える
- バグや期待する動作を説明する
- デザイン変更を指示する
- エラー画面を共有する

### 具体的な指示

**推奨**: 指示は具体的かつ測定可能な表現を使いましょう。

**理由**: 曖昧な指示は解釈のズレを生み、手戻りが発生します。明確な成功基準を示すことで、AIは適切な実装を選択できます。

**具体例**:
- ✅ **良い**: 「この関数の実行時間を50%削減してください」
- ❌ **悪い**: 「最適化して」

- ✅ **良い**: 「インデントを2スペースに統一してください」
- ❌ **悪い**: 「きれいにして」

- ✅ **良い**: 「患者一覧を名前の昇順でソートしてください」
- ❌ **悪い**: 「並び替えて」

### 段階的な指示

**推奨**: 大きな変更は段階的に進めましょう。

**理由**: 一度に多くの変更を指示すると、問題の切り分けが困難になります。

**具体例**:
- ✅ **良い**:
  1. 「まずログイン機能だけ実装してください」
  2. （動作確認後）「次に認証エラーハンドリングを追加してください」
- ❌ **悪い**: 「ログイン機能、エラーハンドリング、リダイレクト、セッション管理を全部実装して」

---

## 推奨ワークフロー

AIアシスタントとの開発で最も効果的なワークフローは **Explore → Plan → Code → Commit** です（Anthropic公式ベストプラクティスより）。

### 1. Explore（探索）

**あなたがやること**:
- 「このプロジェクトの認証まわりの実装を調べてください」
- 「既存のエラーハンドリングパターンを教えてください」

**期待する結果**: 既存のコードパターンを理解した上で、一貫性のある実装を提案できる

### 2. Plan（計画）

**あなたがやること**:
- 「〇〇機能を追加したいです。実装方針を提案してください」
- 提案された計画を確認し、不明点があれば質問する

**期待する結果**: 認識のズレを防ぎ、手戻りを最小化

### 3. Code（実装）

**あなたがやること**:
- 計画に合意したら「この計画で実装してください」と明示的に指示
- （AI側が勝手にコードを出力することはありません。CLAUDE.mdのルールに従います）

**期待する結果**: 計画通りの高品質な実装

### 4. Commit（コミット）

**あなたがやること**:
- 「この変更をコミットしてください」と指示
- コミットメッセージの方針があれば伝える

**期待する結果**: 適切なコミットメッセージで履歴が残る

---

## コンテキストの管理

### /clear を活用する

**推奨**: タスクが完了したら `/clear` でコンテキストをリセットしましょう。

**理由**: 無関係な会話履歴がトークンを消費し、AIの応答速度が低下します。

**使うタイミング**:
- 大きなタスクが完了した後
- 全く別のトピックに切り替える前
- エラー調査が長引いた後の再スタート時

### 一度に一つのタスク

**推奨**: 複数の独立したタスクは分けて依頼しましょう。

**理由**: 同時並行で複数のタスクを依頼すると、AIの集中が分散し品質が低下します。

**具体例**:
- ✅ **良い**:
  1. 「ログイン機能を実装」→ 完了 → `/clear`
  2. 「CSV出力機能を実装」
- ❌ **悪い**: 「ログイン機能とCSV出力機能を実装して」

---

## 参考資料

このガイドは以下の公式ベストプラクティスを参考にしています：

- [Claude Code Best Practices (Anthropic公式)](https://www.anthropic.com/engineering/claude-code-best-practices)
- [Claude Code実践ガイド（日本語ブログ）](https://syu-m-5151.hatenablog.com/entry/2025/06/06/190847)

---

## 変更履歴

| Version | Date | Changes |
|---------|------|---------|
| v1.0 | 2026-01-04 | 初版作成。CLAUDE.md v4.0から「効果的なコミュニケーション」を分離 |
